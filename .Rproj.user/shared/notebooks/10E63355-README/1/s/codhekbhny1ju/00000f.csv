"0","# Download the data"
"0","stations <- fread(""ftp://ftp.ncdc.noaa.gov/pub/data/noaa/isd-history.csv"")"
"2","trying URL 'ftp://ftp.ncdc.noaa.gov/pub/data/noaa/isd-history.csv'
"
"2","Content type 'unknown'"
"2"," length 2902976 bytes (2.8 MB)
"
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","
"
"0","stations[, USAF := as.integer(USAF)]"
"2","Warning: NAs introduced by coercion"
"0","# Dealing with NAs and 999999"
"0","stations[, USAF   := fifelse(USAF == 999999, NA_integer_, USAF)]"
"0","stations[, CTRY   := fifelse(CTRY == """", NA_character_, CTRY)]"
"0","stations[, STATE  := fifelse(STATE == """", NA_character_, STATE)]"
"0",""
"0","# Selecting the three relevant columns, and keeping unique records"
"0","stations <- unique(stations[, list(USAF, CTRY, STATE)])"
"0",""
"0","# Dropping NAs"
"0","stations <- stations[!is.na(USAF)]"
"0",""
"0","# Removing duplicates"
"0","stations[, n := 1:.N, by = .(USAF)]"
"0","stations <- stations[n == 1,][, n := NULL]"
